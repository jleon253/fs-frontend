import{a as ae,b as C,c as le,d as se,e as me,f as ce,g as de,h as pe,i as ue,j as _e,k as ge,l as fe,n as k,o as be,p as ve,q as Ce}from"./chunk-PKNDNEM6.js";import{$ as _,Aa as m,Ba as N,C as e,Cb as oe,K as S,Na as Y,Oa as L,S as x,T as y,W as X,Wa as Z,X as K,Y as g,Z as i,_ as t,d as H,da as Q,e as U,fb as D,ga as f,i as V,ia as j,ib as A,j as $,kb as P,lb as z,mb as ee,ob as te,pa as h,r as b,ra as l,s as G,sa as c,t as J,ta as p,ua as W,ub as ie,va as w,vb as ne,wa as q,x as v,yb as re,za as s}from"./chunk-GJIYDO4A.js";var he={btn:{clear:"Limpiar",add:"Agregar"},table:{total_record:"Total de registros:",size_label:"Mostrar:",actions:"Acciones",loading:"Cargando..."},toast_msg:{success:{title:"\xC9xito",customer_register:"Cliente {{name}} registrado con \xE9xito"},error:{title:"Error",customer_register:"Error registrando al clientes"}},sidebar:{company_name:"CorpBank",links:{customers:"clientes",accounts:"cuentas"}},customer_form:{title:"Nuevo Cliente",required:"Campo requerido",doc_type:{label:"Tipo de Documento",placeholder:"Seleccione tipo de documento",cc:"C\xE9dula de Ciudadan\xEDa",ce:"C\xE9dula de Extranjer\xEDa",pas:"Pasaporte"},doc_number:{label:"N\xFAmero de Documento *",min_value:"(M\xEDnimo {{MIN_CHAR_DOC_NUM}} caracteres)"},full_name:{label:"Nombre Completo",min_value:"(M\xEDnimo {{MIN_CHAR_NAME}} caracteres)"},email:{label:"Email *",invalid_format:"Formato de correo inv\xE1lido"}},customer_list:{title:"Clientes Registrados",search:{placeholder:"Buscar por nombre o documento"},table:{document:"Documento",name:"Nombre",email:"Email",createdAt:"Fecha de Registro",accounts:"Cuentas",customers_not_found:"No se encontraron clientes registrados"}}};var M=(r,o={})=>{let a=r.split(".").reduce((d,u)=>d?.[u],he);if(!a||typeof a!="string")return r;let n=a;return Object.keys(o).forEach(d=>{n=n.replace(`{{${d}}}`,String(o[d]))}),n};var Ie=r=>({MIN_CHAR_DOC_NUM:r}),Fe=r=>({MIN_CHAR_NAME:r});function Ne(r,o){r&1&&(i(0,"div",16),l(1),s(2,"translate"),t()),r&2&&(e(),c(m(2,1,"customer_form.required")))}function Me(r,o){r&1&&(i(0,"div",16),l(1),s(2,"translate"),t()),r&2&&(e(),c(m(2,1,"customer_form.required")))}function Te(r,o){r&1&&(i(0,"div",16),l(1),s(2,"translate"),t()),r&2&&(e(),c(m(2,1,"customer_form.email.invalid_format")))}var Be={bootstrapPersonFillAdd:ie,bootstrapXCircle:oe},O=class r{MIN_CHAR_DOC_NUM=10;MIN_CHAR_NAME=3;fb=b(ge);customerService=b(k);toastr=b(D);isSubmiting=v(!1);customerForm=this.fb.group({document_type:["",[C.required]],document_number:["",[C.required,C.minLength(10)]],full_name:["",[C.required,C.minLength(3)]],email:["",[C.required,C.email]]});onSubmit(){this.customerForm.invalid||this.isSubmiting()||(this.isSubmiting.set(!0),this.customerService.createCustomer(this.customerForm.value).subscribe({next:o=>{this.toastr.success(M("toast_msg.success.customer_register",{name:o.data.full_name}),M("toast_msg.success.title")),this.customerForm.reset({document_type:""}),this.isSubmiting.set(!1)},error:o=>{this.isSubmiting.set(!1),this.toastr.error(o.error?.message||M("toast_msg.error.customer_register"),M("toast_msg.error.title"))}}))}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=S({type:r,selectors:[["app-customer-form"]],features:[w([P(Be)])],decls:56,vars:58,consts:[[1,"card","shadow-sm","border-0"],[1,"card-body","p-4"],[1,"card-title","mb-4","d-flex","align-items-center"],[1,"text-body-tertiary","rounded","p-2","me-2","d-flex"],["name","bootstrapPersonFillAdd"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","",1,"form-label","fw-medium"],["id","select-document-type","formControlName","document_type",1,"form-select"],["value",""],["value","CC"],["value","CE"],["value","PAS"],["for","txt-document-number",1,"form-label","fw-medium"],[1,"text-body-tertiary",2,"font-size",".8rem"],["id","txt-document-number","type","text","formControlName","document_number","placeholder","1928837432",1,"form-control"],[1,"invalid-feedback"],["for","txt-full-name",1,"form-label","fw-medium"],["id","txt-full-name","type","text","formControlName","full_name","placeholder","John Doe",1,"form-control"],[1,"mb-4"],["for","txt-email",1,"form-label","fw-medium"],["id","txt-email","type","email","formControlName","email","placeholder","john.doe@example.com",1,"form-control"],[1,"d-grid","gap-2","d-md-flex","justify-content-md-end"],["type","button",1,"btn","btn-outline-secondary","btn-sm","px-4",3,"click"],["type","submit",1,"btn","btn-primary","btn-sm","px-4",3,"disabled"]],template:function(a,n){if(a&1&&(i(0,"div",0)(1,"div",1)(2,"h5",2)(3,"div",3),_(4,"ng-icon",4),t(),l(5),s(6,"translate"),t(),i(7,"form",5),f("ngSubmit",function(){return n.onSubmit()}),i(8,"div",6)(9,"label",7),l(10),s(11,"translate"),t(),i(12,"select",8)(13,"option",9),l(14),s(15,"translate"),t(),i(16,"option",10),l(17),s(18,"translate"),t(),i(19,"option",11),l(20),s(21,"translate"),t(),i(22,"option",12),l(23),s(24,"translate"),t()()(),i(25,"div",6)(26,"label",13),l(27),s(28,"translate"),i(29,"span",14),l(30),s(31,"translate"),t()(),_(32,"input",15),x(33,Ne,3,3,"div",16),t(),i(34,"div",6)(35,"label",17),l(36),s(37,"translate"),i(38,"span",14),l(39),s(40,"translate"),t()(),_(41,"input",18),t(),i(42,"div",19)(43,"label",20),l(44),s(45,"translate"),t(),_(46,"input",21),x(47,Me,3,3,"div",16),x(48,Te,3,3,"div",16),t(),i(49,"div",22)(50,"button",23),f("click",function(){return n.customerForm.reset()}),l(51),s(52,"translate"),t(),i(53,"button",24),l(54),s(55,"translate"),t()()()()()),a&2){let d,u,E,T,B,I,F;e(5),p(" ",m(6,26,"customer_form.title")," "),e(2),g("formGroup",n.customerForm),e(3),c(m(11,28,"customer_form.doc_type.label")),e(2),h("is-invalid",((d=n.customerForm.get("document_type"))==null?null:d.touched)&&((d=n.customerForm.get("document_type"))==null?null:d.invalid)),e(2),c(m(15,30,"customer_form.doc_type.placeholder")),e(3),c(m(18,32,"customer_form.doc_type.cc")),e(3),c(m(21,34,"customer_form.doc_type.ce")),e(3),c(m(24,36,"customer_form.doc_type.pas")),e(4),p(" ",m(28,38,"customer_form.doc_number.label")," "),e(3),p(" ",N(31,40,"customer_form.doc_number.min_value",q(54,Ie,n.MIN_CHAR_DOC_NUM))," "),e(2),h("is-invalid",((u=n.customerForm.get("document_number"))==null?null:u.touched)&&((u=n.customerForm.get("document_number"))==null?null:u.invalid)),e(),y(!((E=n.customerForm.get("document_number"))==null||E.errors==null)&&E.errors.required&&((E=n.customerForm.get("document_number"))!=null&&E.touched)?33:-1),e(3),p(" ",m(37,43,"customer_form.full_name.label")," "),e(3),p(" ",N(40,45,"customer_form.full_name.min_value",q(56,Fe,n.MIN_CHAR_NAME))," "),e(2),h("is-invalid",((T=n.customerForm.get("full_name"))==null?null:T.touched)&&((T=n.customerForm.get("full_name"))==null?null:T.invalid)),e(3),p(" ",m(45,48,"customer_form.email.label")," "),e(2),h("is-invalid",((B=n.customerForm.get("email"))==null?null:B.touched)&&((B=n.customerForm.get("email"))==null?null:B.invalid)),e(),y(!((I=n.customerForm.get("email"))==null||I.errors==null)&&I.errors.required&&((I=n.customerForm.get("email"))!=null&&I.touched)?47:-1),e(),y(!((F=n.customerForm.get("email"))==null||F.errors==null)&&F.errors.email&&((F=n.customerForm.get("email"))!=null&&F.touched)?48:-1),e(3),p(" ",m(52,50,"btn.clear")," "),e(2),g("disabled",n.customerForm.invalid),e(),p(" ",m(55,52,"btn.add")," ")}},dependencies:[L,fe,me,ue,_e,ae,pe,le,se,ce,de,z,A],encapsulation:2})};var we=(r,o)=>o.id;function Le(r,o){if(r&1){let a=Q();i(0,"tr")(1,"td")(2,"div",18)(3,"div",19),l(4),t(),i(5,"div"),l(6),t()()(),i(7,"td")(8,"p",20),l(9),t()(),i(10,"td"),l(11),t(),i(12,"td"),l(13),s(14,"date"),t(),i(15,"td")(16,"button",21),f("click",function(){let d=G(a).$implicit,u=j();return J(u.navigateToCustomerAccounts(d.document_number))}),_(17,"ng-icon",22),l(18),s(19,"translate"),t()()()}if(r&2){let a=o.$implicit;e(4),p(" ",a.document_type," "),e(2),c(a.document_number),e(2),g("title",a.full_name),e(),p(" ",a.full_name," "),e(2),c(a.email),e(2),c(N(14,7,a.created_at,"dd/MM/yyyy")),e(5),p(" ",m(19,10,"customer_list.table.accounts")," ")}}function De(r,o){r&1&&(_(0,"div",23),l(1),s(2,"translate")),r&2&&(e(),p(" ",m(2,1,"table.loading")," "))}function Ae(r,o){r&1&&(l(0),s(1,"translate")),r&2&&p(" ",m(1,1,"customer_list.table.customers_not_found")," ")}function Pe(r,o){if(r&1&&(i(0,"tr")(1,"td"),x(2,De,3,3)(3,Ae,2,3),t()()),r&2){let a=j();e(2),y(a.isLoading()?2:3)}}var ze={bootstrapArrowClockwise:ee,bootstrapPersonPlus:ne,bootstrapSearch:re,bootstrapBoxArrowUpRight:te},R=class r{customerService=b(k);toastr=b(D);router=b(Z);sub=new H;searchSubject=new U;customers=this.customerService.customers;page=v(1);pageSize=v(5);totalItems=v(0);searchTerm=v("");isLoading=v(!1);ngOnInit(){this.loadCustomers(),this.refreshList(),this.searchConfigure()}onPageChange(o){this.page.set(o),this.loadCustomers()}refreshList(){let o=this.customerService.customerCreated$.subscribe(()=>{this.page.set(1),this.loadCustomers()});this.sub.add(o)}changePageSize(o){this.pageSize.set(o),this.page.set(1),this.loadCustomers()}searchConfigure(){this.searchSubject.pipe(V(300),$()).subscribe(o=>{this.searchTerm.set(o),this.page.set(1),this.loadCustomers()}),this.sub.add(this.searchSubject)}onSearch(o){let a=o.target;this.searchSubject.next(a.value)}loadCustomers(){this.isLoading.set(!0);let o=this.customerService.getCustomers(this.page(),this.pageSize(),this.searchTerm()).subscribe({next:a=>{this.totalItems.set(a.meta.total),this.isLoading.set(!1)},error:a=>{this.isLoading.set(!1),this.toastr.error("No se pudo conectar con el servidor","Error de conexi\xF3n"),console.error(a)}});this.sub.add(o)}navigateToCustomerAccounts(o){this.router.navigate(["/accounts"],{queryParams:{documentNumber:o}})}ngOnDestroy(){this.sub.unsubscribe()}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=S({type:r,selectors:[["app-customer-list"]],features:[w([P(ze)])],decls:44,vars:35,consts:[[1,"card","shadow-sm"],[1,"card-header","d-flex","flex-column","justify-content-between","align-items-center","gap-3"],[1,"d-flex","justify-content-between","align-items-center","w-100"],[1,"card-title","m-0"],[1,"btn","bg-transparent",3,"click","disabled"],["name","bootstrapArrowClockwise"],[1,"input-group"],[1,"input-group-text","border-end-0"],["name","bootstrapSearch"],["type","text",1,"form-control","border-start-0","ps-0",3,"input","placeholder"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"card-footer","d-flex","flex-column","flex-md-row","gap-2","justify-content-between","align-items-center"],[1,"d-flex","justify-content-between","align-items-center","gap-2","w-100"],[1,"text-muted","small"],[3,"sizeChange","pageSize"],["size","sm",3,"pageChange","collectionSize","page","pageSize","maxSize","boundaryLinks"],[1,"d-flex","align-items-center",2,"flex-wrap","nowrap"],[1,"badge","text-bg-secondary","me-1",2,"width","40px"],[1,"d-inline-block","text-truncate",2,"max-width","90%",3,"title"],[1,"btn","btn-sm","btn-outline-info",3,"click"],["name","bootstrapBoxArrowUpRight"],[1,"spinner-border","spinner-border-sm","text-primary"]],template:function(a,n){a&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),l(4),s(5,"translate"),t(),i(6,"button",4),f("click",function(){return n.loadCustomers()}),_(7,"ng-icon",5),t()(),i(8,"div",6)(9,"span",7),_(10,"ng-icon",8),t(),i(11,"input",9),s(12,"translate"),f("input",function(u){return n.onSearch(u)}),t()()(),i(13,"div",10)(14,"div",11)(15,"table",12)(16,"thead")(17,"tr")(18,"th"),l(19),s(20,"translate"),t(),i(21,"th"),l(22),s(23,"translate"),t(),i(24,"th"),l(25),s(26,"translate"),t(),i(27,"th"),l(28),s(29,"translate"),t(),i(30,"th"),l(31),s(32,"translate"),t()()(),i(33,"tbody"),X(34,Le,20,12,"tr",null,we,!1,Pe,4,1,"tr"),t()()()(),i(37,"div",13)(38,"div",14)(39,"div",15),l(40),s(41,"translate"),t(),i(42,"app-page-size-selector",16),f("sizeChange",function(u){return n.changePageSize(u)}),t()(),i(43,"ngb-pagination",17),f("pageChange",function(u){return n.onPageChange(u)}),t()()()),a&2&&(e(4),p(" ",m(5,19,"customer_list.title")," "),e(2),g("disabled",n.isLoading()),e(),h("spin",n.isLoading()),e(4),g("placeholder",m(12,21,"customer_list.search.placeholder")),e(8),c(m(20,23,"customer_list.table.document")),e(3),c(m(23,25,"customer_list.table.name")),e(3),c(m(26,27,"customer_list.table.email")),e(3),c(m(29,29,"customer_list.table.createdAt")),e(3),c(m(32,31,"table.actions")),e(3),K(n.customers()),e(6),W("",m(41,33,"table.total_record")," ",n.totalItems()),e(2),g("pageSize",n.pageSize()),e(),g("collectionSize",n.totalItems())("page",n.page())("pageSize",n.pageSize())("maxSize",5)("boundaryLinks",!0))},dependencies:[L,z,ve,be,Ce,Y,A],encapsulation:2})};var ye=class r{static \u0275fac=function(a){return new(a||r)};static \u0275cmp=S({type:r,selectors:[["app-customer-management"]],decls:5,vars:0,consts:[[1,"row","g-4","m-2"],[1,"col-lg-5","col-xl-4"],[1,"col-lg-7","col-xl-8"]],template:function(a,n){a&1&&(i(0,"div",0)(1,"div",1),_(2,"app-customer-form"),t(),i(3,"div",2),_(4,"app-customer-list"),t()())},dependencies:[O,R],encapsulation:2})};export{ye as CustomerManagement};
